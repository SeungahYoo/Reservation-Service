<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nts.reservation.mapper.ProductMapper" >
	<select id="selectProducts" parameterType="map" resultType="com.nts.reservation.dto.Product">
			SELECT 
				display_info.id displayInfoId,
				product.id id, 
				product.description productDescription, 
				product.content productContent, 
				display_info.place_name placeName, 
				file_info.save_file_name productImageUrl
			FROM 
				product 
			JOIN 
				display_info 
			ON 
				product.id = display_info.product_id
			JOIN 
				product_image 
			ON
				product.id=product_image.product_id
			JOIN 
				file_info 
			ON
				product_image.file_id = file_info.id
			WHERE
				product_image.type=#{imageType}
			<if test="categoryId  gt 0">
			AND
				product.category_id=#{categoryId}
			</if>
			LIMIT
				#{startIndex} , #{maxCount}
	</select>
	

</mapper>